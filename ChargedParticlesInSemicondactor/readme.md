В данной программе производим рассчет
заряженных частицы в полупроводнике.
Точнее считаем $N_d^-$, p, n, Q

Пусть ширина запрещенной зоны $E_g = 1.12eV$
$J_d = E_c - E_g = 50 meV$

1) Уравнение электронейтральности:
    $n + N_d^-= p$

2) Ef - уровень Ферми, Ec - дно зоны проводимости,
Ev - потолок валентной зоны
    $n = N_c * exp(- \frac{E_c - E_f}{kT})$
    $p = N_v * exp(- \frac{E_f - E_v}{kT} )$

    Получаем $N_d^- = \frac{N_d}{1 + 4 * exp(\frac{Ef - Eg}{kT})}$

 $Q = N_d^- + n - p$ - суммарный заряд.
I. Предположим, что $N_d^- = 0$ -> полупроводник собственный:
    $E_f^+ = \frac{Ec + Ev}{2} + \frac{3}{4}kT \factor ln(m_e^{*}/m_h^{*})$

II. Уровень Ферми совпадает с границей зоны проводимости при
$N_d=10^17$ -> статистика не вырожденная:
    $N_c(Si, T=300K) ~ 10^19$
Т.о. на втором участке заряд гарантировано отрицательный,
    $E_f1 = \frac{E_f^+ - E_f^-)}{2}$

Решаем методом дихатомии. Уровень ферми там, где суммарный заряд Q почти нулевой.

Для легированного Донорами:

Стартуем с: 
$E_f^i = \frac{E_c + E_f^+}{2}$, считаем все заряды

если Q > 0: в интервал: $(E_f^i; E_f^+)$;
если Q < 0: в интервал: $(E_c; E_f^i)$.

Делаем так, пока доля суммарного заряда от сумме зарядов основных носителей
не будет составлять 0.01%, т.е.  $\frac{Q}{p + N_d^+} = 0.0001$

Для легированного Акцепторами:

$N_a^- = N_a \frac{1}{1 + 4 exp(\frac{E_f - E_a}{kT})}$

Стартуем с: 
$E_f^i = \frac{E_c + E_f^+}{2}$, считаем все заряды

если Q < 0: в интервал: $(E_f^i; E_f^+)$;
если Q > 0: в интервал: $(E_c; E_f^i)$.

Делаем так, пока доля суммарного заряда от сумме зарядов основных носителей
не будет составлять 0.01%, т.е.  $\frac{Q}{n + N_a^-} = 0.0001$